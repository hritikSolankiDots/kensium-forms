<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>BDR Lead Qualification Form</title>
  <link rel="icon" type="image/png" href="/public/favicon.png" />
  <script src="https://cdn.tailwindcss.com"></script>
  <script src="https://unpkg.com/alpinejs@3.x.x/dist/cdn.min.js" defer></script>
  <link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/npm/toastify-js/src/toastify.min.css" />
  <script type="text/javascript" src="https://cdn.jsdelivr.net/npm/toastify-js"></script>
</head>

<body class="bg-gray-50 min-h-screen">
  <!-- loader overlay -->
  <div id="form-loader"
    class="fixed inset-0 bg-gray-900 bg-opacity-50 flex flex-col items-center justify-center space-y-4 z-50 hidden">
    <!-- spinner -->
    <div class="w-12 h-12 border-4 border-gray-200 border-t-blue-500 rounded-full animate-spin"></div>
    <!-- updated message -->
    <p class="text-lg font-medium text-white">
      Form is submitting…
    </p>
  </div>
  <div class="w-full max-w-none mx-auto p-4 md:p-8">
    <!-- Header -->
    <header class="sticky top-0 bg-white shadow z-20">
      <div class="mx-auto px-4 py-2 flex flex-col md:flex-row md:justify-between md:items-center">
        <!-- Title -->
        <div class="text-center md:text-left mb-4 md:mb-0">
          <h1 class="text-2xl md:text-3xl font-bold text-gray-800">
            BDR Lead Qualification Form
          </h1>
          <p class="text-gray-600">
            Complete lead assessment and qualification
          </p>
        </div>

        <!-- Client Info (only if contact exists) -->
        <% if (deal && deal.properties && contact && contact.properties) { %>
          <div class="bg-blue-50 border border-blue-200 rounded-lg shadow p-4 w-full md:w-auto">
            <div class="space-y-1 text-gray-900">
              <div class="flex items-center">
                <span class="w-24 font-medium text-gray-600">Deal Name:</span>
                <span>
                  <%= deal.properties.dealname %>
                </span>
              </div>
              <div class="flex items-center">
                <span class="w-24 font-medium text-gray-600">Contact:</span>
                <span>
                  <%= contact.properties.firstname %>
                    <%= contact.properties.lastname %> &nbsp;/&nbsp; <%= contact.properties.email %>
                </span>
              </div>
            </div>
          </div>
          <% } %>
      </div>
    </header>
    <!-- Main Form -->
    <main class="bg-white rounded-lg shadow-lg p-6 md:p-8">
      <form id="bdrForm" class="space-y-8" method="POST" action="/bdr-form">
        <input type="hidden" name="dealId" value="<%= deal.id %>" />
        <!-- Basic Information Section -->
        <div class="border-b border-gray-200 pb-8">
          <h2 class="text-xl md:text-2xl font-bold text-gray-800 mb-6">
            Basic Information
          </h2>

          <div class="grid grid-cols-1 md:grid-cols-2 xl:grid-cols-3 gap-6">
            <!-- Company Background -->
            <div class="md:col-span-2 xl:col-span-3">
              <label class="block text-sm font-semibold text-gray-700 mb-2">
                Company Background <span class="text-red-500">*</span>
              </label>
              <textarea name="company_background"
                class="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent resize-none"
                rows="3" placeholder="Tell us about your company..."><%= formData.company_background %></textarea>
              <div class="text-red-600 text-sm mt-1" id="error_company_background"></div>
            </div>

            <!-- Role of Contact -->
            <div>
              <label class="block text-sm font-semibold text-gray-700 mb-2">
                Role of the Contact <span class="text-red-500">*</span>
              </label>
              <input type="text" name="contact_role"
                class="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"
                placeholder="Your role/title" value="<%= formData.contact_role %>" />
              <div class="text-red-600 text-sm mt-1" id="error_contact_role"></div>
            </div>

            <!-- How did you hear about us -->
            <div>
              <label class="block text-sm font-semibold text-gray-700 mb-2">
                How did you hear about Kensium?
                <span class="text-red-500">*</span>
              </label>
              <select name="hear_about_us"
                class="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent">
                <option value="">Select an option</option>
                <option value="Partner / VAR" <%=formData.hear_about_us==="Partner / VAR" ? "selected" : "" %> >Partner
                  / VAR</option>
                <option value="Acumatica" <%=formData.hear_about_us==="Acumatica" ? "selected" : "" %> >Acumatica
                </option>
                <option value="Adobe" <%=formData.hear_about_us==="Adobe" ? "selected" : "" %> >Adobe</option>
                <option value="BigCommerce" <%=formData.hear_about_us==="BigCommerce" ? "selected" : "" %>>BigCommerce
                </option>
                <option value="Sage" <%=formData.hear_about_us==="Sage" ? "selected" : "" %> >Sage</option>
                <option value="Shopify" <%=formData.hear_about_us==="Shopify" ? "selected" : "" %> >Shopify</option>
                <option value="Internet" <%=formData.hear_about_us==="Internet" ? "selected" : "" %> >Internet</option>
                <option value="Social" <%=formData.hear_about_us==="Social" ? "selected" : "" %> >Social</option>
                <option value="Industry Event" <%=formData.hear_about_us==="Industry Event" ? "selected" : "" %>>
                  Industry Event</option>
                <option value="Existing Relationship" <%=formData.hear_about_us==="Existing Relationship" ? "selected"
                  : "" %> >
                  Existing Relationship
                </option>
                <option value="Other" <%=formData.hear_about_us==="Other" ? "selected" : "" %> >Other</option>
              </select>
              <div class="text-red-600 text-sm mt-1" id="error_hear_about_us"></div>
            </div>

            <!-- Existing VAR -->
            <div>
              <label class="block text-sm font-semibold text-gray-700 mb-2">
                Existing VAR (if working with an ERP)
              </label>
              <input type="text" name="existing_var"
                class="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"
                placeholder="VAR name if applicable" value="<%= formData.existing_var %>" />
            </div>

            <!-- Interested In -->
            <div class="md:col-span-2 xl:col-span-3">
              <label class="block text-sm font-semibold text-gray-700 mb-2">
                Interested in? <span class="text-red-500">*</span>
              </label>
              <div class="flex flex-wrap gap-4">
                <label class="flex items-center space-x-2">
                  <input type="checkbox" name="interested_in[]" value="Products" <%=formData.interested_in &&
                    formData.interested_in.includes("Products") ? "checked" : "" %> class="rounded text-blue-600
                  focus:ring-blue-500" />
                  <span class="text-sm">Products</span>
                </label>
                <label class="flex items-center space-x-2">
                  <input type="checkbox" name="interested_in[]" value="Ecommerce"
                    class="rounded text-blue-600 focus:ring-blue-500" <%=formData.interested_in &&
                    formData.interested_in.includes("Ecommerce") ? "checked" : "" %> />
                  <span class="text-sm">Ecommerce</span>
                </label>
                <label class="flex items-center space-x-2">
                  <input type="checkbox" name="interested_in[]" value="Acumatica"
                    class="rounded text-blue-600 focus:ring-blue-500" <%=formData.interested_in &&
                    formData.interested_in.includes("Acumatica") ? "checked" : "" %> />
                  <span class="text-sm">Acumatica</span>
                </label>
                <label class="flex items-center space-x-2">
                  <input type="checkbox" name="interested_in[]" value="Staffing"
                    class="rounded text-blue-600 focus:ring-blue-500" <%=formData.interested_in &&
                    formData.interested_in.includes("Staffing") ? "checked" : "" %> />
                  <span class="text-sm">Staffing</span>
                </label>
                <label class="flex items-center space-x-2">
                  <input type="checkbox" name="interested_in[]" value="Other"
                    class="rounded text-blue-600 focus:ring-blue-500" <%=formData.interested_in &&
                    formData.interested_in.includes("Other") ? "checked" : "" %> />
                  <span class="text-sm">Other</span>
                </label>
              </div>
              <div class="text-red-600 text-sm mt-1" id="error_interested_in"></div>
            </div>

            <!-- Product(s) Interested In -->
            <div class="md:col-span-2 xl:col-span-3">
              <label class="block text-sm font-semibold text-gray-700 mb-2">
                Product(s) interested in
              </label>
              <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-2">
                <label class="flex items-center">
                  <input type="checkbox" name="products_interested_in[]" value="Acumatica - Adobe (Magento) Connector"
                    class="rounded text-blue-600 focus:ring-blue-500" <%=formData.products_interested_in &&
                    formData.products_interested_in.includes("Acumatica - Adobe (Magento) Connector") ? "checked" : ""
                    %> />
                  <span class="ml-2 text-sm">Acumatica - Adobe (Magento) Connector</span>
                </label>
                <label class="flex items-center">
                  <input type="checkbox" name="products_interested_in[]" value="Acumatica - BigCommerce B2B Connector"
                    class="rounded text-blue-600 focus:ring-blue-500" <%=formData.products_interested_in &&
                    formData.products_interested_in.includes("Acumatica - BigCommerce B2B Connector") ? "checked" : ""
                    %> />
                  <span class="ml-2 text-sm">Acumatica - BigCommerce B2B Connector</span>
                </label>
                <label class="flex items-center">
                  <input type="checkbox" name="products_interested_in[]" value="Acumatica - Braintree Plugin"
                    class="rounded text-blue-600 focus:ring-blue-500" <%=formData.products_interested_in &&
                    formData.products_interested_in.includes("Acumatica - Braintree Plugin") ? "checked" : "" %> />
                  <span class="ml-2 text-sm">Acumatica - Braintree Plugin</span>
                </label>
                <label class="flex items-center">
                  <input type="checkbox" name="products_interested_in[]" value="Acumatica - Build Your Product"
                    class="rounded text-blue-600 focus:ring-blue-500" <%=formData.products_interested_in &&
                    formData.products_interested_in.includes("Acumatica - Build Your Product") ? "checked" : "" %> />
                  <span class="ml-2 text-sm">Acumatica - Build Your Product</span>
                </label>
                <label class="flex items-center">
                  <input type="checkbox" name="products_interested_in[]" value="Acumatica - CommercePro"
                    class="rounded text-blue-600 focus:ring-blue-500" <%=formData.products_interested_in &&
                    formData.products_interested_in.includes("Acumatica - CommercePro") ? "checked" : "" %> />
                  <span class="ml-2 text-sm">Acumatica - CommercePro</span>
                </label>
                <label class="flex items-center">
                  <input type="checkbox" name="products_interested_in[]" value="Acumatica - India Fixed Assets"
                    class="rounded text-blue-600 focus:ring-blue-500" <%=formData.products_interested_in &&
                    formData.products_interested_in.includes("Acumatica - India Fixed Assets") ? "checked" : "" %> />
                  <span class="ml-2 text-sm">Acumatica - India Fixed Assets</span>
                </label>
                <label class="flex items-center">
                  <input type="checkbox" name="products_interested_in[]" value="Acumatica - India Localization"
                    class="rounded text-blue-600 focus:ring-blue-500" <%=formData.products_interested_in &&
                    formData.products_interested_in.includes("Acumatica - India Localization") ? "checked" : "" %> />
                  <span class="ml-2 text-sm">Acumatica - India Localization</span>
                </label>
                <label class="flex items-center">
                  <input type="checkbox" name="products_interested_in[]" value="Acumatica - Kensium Commerce Framework"
                    class="rounded text-blue-600 focus:ring-blue-500" <%=formData.products_interested_in &&
                    formData.products_interested_in.includes("Acumatica - Kensium Commerce Framework") ? "checked" : ""
                    %> />
                  <span class="ml-2 text-sm">Acumatica - Kensium Commerce Framework</span>
                </label>
                <label class="flex items-center">
                  <input type="checkbox" name="products_interested_in[]" value="Acumatica - KensiumPOS"
                    class="rounded text-blue-600 focus:ring-blue-500" <%=formData.products_interested_in &&
                    formData.products_interested_in.includes("Acumatica - KensiumPOS") ? "checked" : "" %> />
                  <span class="ml-2 text-sm">Acumatica - KensiumPOS</span>
                </label>
                <label class="flex items-center">
                  <input type="checkbox" name="products_interested_in[]" value="Acumatica - KensiumWMS"
                    class="rounded text-blue-600 focus:ring-blue-500" <%=formData.products_interested_in &&
                    formData.products_interested_in.includes("Acumatica - KensiumWMS") ? "checked" : "" %> />
                  <span class="ml-2 text-sm">Acumatica - KensiumWMS</span>
                </label>
                <label class="flex items-center">
                  <input type="checkbox" name="products_interested_in[]" value="Acumatica - PayPal Invoicing"
                    class="rounded text-blue-600 focus:ring-blue-500" <%=formData.products_interested_in &&
                    formData.products_interested_in.includes("Acumatica - PayPal Invoicing") ? "checked" : "" %> />
                  <span class="ml-2 text-sm">Acumatica - PayPal Invoicing</span>
                </label>
                <label class="flex items-center">
                  <input type="checkbox" name="products_interested_in[]" value="Acumatica - PayPal Payflow Plugin"
                    class="rounded text-blue-600 focus:ring-blue-500" <%=formData.products_interested_in &&
                    formData.products_interested_in.includes("Acumatica - PayPal Payflow Plugin") ? "checked" : "" %> />
                  <span class="ml-2 text-sm">Acumatica - PayPal Payflow Plugin</span>
                </label>
                <label class="flex items-center">
                  <input type="checkbox" name="products_interested_in[]"
                    value="Acumatica - Rithum (ChannelAdvisior) Connector"
                    class="rounded text-blue-600 focus:ring-blue-500" <%=formData.products_interested_in &&
                    formData.products_interested_in.includes("Acumatica - Rithum (ChannelAdvisior) Connector")
                    ? "checked" : "" %> />
                  <span class="ml-2 text-sm">Acumatica - Rithum (ChannelAdvisior) Connector</span>
                </label>
                <label class="flex items-center">
                  <input type="checkbox" name="products_interested_in[]" value="Acumatica - SellerCloud Connector"
                    class="rounded text-blue-600 focus:ring-blue-500" <%=formData.products_interested_in &&
                    formData.products_interested_in.includes("Acumatica - SellerCloud Connector") ? "checked" : "" %> />
                  <span class="ml-2 text-sm">Acumatica - SellerCloud Connector</span>
                </label>
                <label class="flex items-center">
                  <input type="checkbox" name="products_interested_in[]" value="ERPCommerce / Boomi Connector"
                    class="rounded text-blue-600 focus:ring-blue-500" <%=formData.products_interested_in &&
                    formData.products_interested_in.includes("ERPCommerce / Boomi Connector") ? "checked" : "" %> />
                  <span class="ml-2 text-sm">ERPCommerce / Boomi Connector</span>
                </label>
                <label class="flex items-center">
                  <input type="checkbox" name="products_interested_in[]" value="Sage - KensiumPOS"
                    class="rounded text-blue-600 focus:ring-blue-500" <%=formData.products_interested_in &&
                    formData.products_interested_in.includes("Sage - KensiumPOS") ? "checked" : "" %> />
                  <span class="ml-2 text-sm">Sage - KensiumPOS</span>
                </label>
                <label class="flex items-center">
                  <input type="checkbox" name="products_interested_in[]" value="UnifiCX"
                    class="rounded text-blue-600 focus:ring-blue-500" <%=formData.products_interested_in &&
                    formData.products_interested_in.includes("UnifiCX") ? "checked" : "" %> />
                  <span class="ml-2 text-sm">UnifiCX</span>
                </label>
                <label class="flex items-center">
                  <input type="checkbox" name="products_interested_in[]" value="Other"
                    class="rounded text-blue-600 focus:ring-blue-500" <%=formData.products_interested_in &&
                    formData.products_interested_in.includes("Other") ? "checked" : "" %> />
                  <span class="ml-2 text-sm">Other</span>
                </label>
              </div>
            </div>

            <!-- Services Interested In -->
            <div class="md:col-span-2 xl:col-span-3">
              <label class="block text-sm font-semibold text-gray-700 mb-2">
                Service(s) interested in <span class="text-red-500">*</span>
              </label>
              <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-2">
                <label class="flex items-center space-x-2">
                  <input type="checkbox" name="services_interested[]" value="Branding"
                    class="rounded text-blue-600 focus:ring-blue-500" <%=formData.services_interested &&
                    formData.services_interested.includes("Branding") ? "checked" : "" %> />
                  <span class="text-sm">Branding</span>
                </label>
                <label class="flex items-center space-x-2">
                  <input type="checkbox" name="services_interested[]" value="Connectors"
                    class="rounded text-blue-600 focus:ring-blue-500" <%=formData.services_interested &&
                    formData.services_interested.includes("Connectors") ? "checked" : "" %> />
                  <span class="text-sm">Connectors</span>
                </label>
                <label class="flex items-center space-x-2">
                  <input type="checkbox" name="services_interested[]" value="Creative Services"
                    class="rounded text-blue-600 focus:ring-blue-500" <%=formData.services_interested &&
                    formData.services_interested.includes("Creative Services") ? "checked" : "" %> />
                  <span class="text-sm">Creative Services</span>
                </label>
                <label class="flex items-center space-x-2">
                  <input type="checkbox" name="services_interested[]" value="Digital Marketing"
                    class="rounded text-blue-600 focus:ring-blue-500" <%=formData.services_interested &&
                    formData.services_interested.includes("Digital Marketing") ? "checked" : "" %> />
                  <span class="text-sm">Digital Marketing</span>
                </label>
                <label class="flex items-center space-x-2">
                  <input type="checkbox" name="services_interested[]" value="Ecommerce"
                    class="rounded text-blue-600 focus:ring-blue-500" <%=formData.services_interested &&
                    formData.services_interested.includes("Ecommerce") ? "checked" : "" %> />
                  <span class="text-sm">Ecommerce</span>
                </label>
                <label class="flex items-center space-x-2">
                  <input type="checkbox" name="services_interested[]" value="Other"
                    class="rounded text-blue-600 focus:ring-blue-500" <%=formData.services_interested &&
                    formData.services_interested.includes("Other") ? "checked" : "" %> />
                  <span class="text-sm">Other</span>
                </label>
              </div>
              <div class="text-red-600 text-sm mt-1" id="error_services_interested"></div>
            </div>
          </div>
        </div>

        <!-- Needs Assessment & Timeline Section -->
        <div class="border-b border-gray-200 pb-8">
          <h2 class="text-xl md:text-2xl font-bold text-gray-800 mb-6">
            Needs Assessment & Timeline
          </h2>

          <div class="grid grid-cols-1 md:grid-cols-2 xl:grid-cols-3 gap-6">
            <!-- Current Challenges -->
            <div class="md:col-span-2 xl:col-span-3">
              <label class="block text-sm font-semibold text-gray-700 mb-2">
                What challenges are you currently facing in [relevant area]?
              </label>
              <textarea name="current_challenges"
                class="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent resize-none"
                rows="3" placeholder="Describe your current challenges..."><%= formData.current_challenges %></textarea>
            </div>

            <!-- Solution Prompt -->
            <div class="md:col-span-2 xl:col-span-3">
              <label class="block text-sm font-semibold text-gray-700 mb-2">
                What prompted you to look for a solution now?
              </label>
              <textarea name="solution_prompt"
                class="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent resize-none"
                rows="3"
                placeholder="What triggered your search for a solution?"><%= formData.solution_prompt %></textarea>
            </div>

            <!-- Implementation Timeline -->
            <div>
              <label class="block text-sm font-semibold text-gray-700 mb-2">
                When are you looking to implement a solution?
                <span class="text-red-500">*</span>
              </label>
              <select name="implementation_timeline"
                class="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent">
                <option value="">Select timeline</option>
                <option value="Immediate" <%=formData.implementation_timeline==="Immediate" ? "selected" : "" %>
                  >Immediate</option>
                <option value="30 days" <%=formData.implementation_timeline==="30 days" ? "selected" : "" %> >30 days
                </option>
                <option value="60 days" <%=formData.implementation_timeline==="60 days" ? "selected" : "" %> >60 days
                </option>
                <option value="90 days" <%=formData.implementation_timeline==="90 days" ? "selected" : "" %> >90 days
                </option>
                <option value="This Year" <%=formData.implementation_timeline==="This Year" ? "selected" : "" %> >This
                  Year</option>
                <option value="Unknown" <%=formData.implementation_timeline==="Unknown" ? "selected" : "" %> >Unknown
                </option>
              </select>
              <div class="text-red-600 text-sm mt-1" id="error_implementation_timeline"></div>
            </div>

            <!-- Urgency -->
            <div>
              <label class="block text-sm font-semibold text-gray-700 mb-2">
                How urgent is this need on your priority list?
                <span class="text-red-500">*</span>
              </label>
              <select name="urgency_level"
                class="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent">
                <option value="">Select urgency</option>
                <option value="Urgent" <%=formData.urgency_level==="Urgent" ? "selected" : "" %> >Urgent</option>
                <option value="High Priority" <%=formData.urgency_level==="High Priority" ? "selected" : "" %> >High
                  Priority</option>
                <option value="Medium Priority" <%=formData.urgency_level==="Medium Priority" ? "selected" : "" %>
                  >Medium Priority</option>
                <option value="Low Priority" <%=formData.urgency_level==="Low Priority" ? "selected" : "" %> >Low
                  Priority</option>
              </select>
              <div class="text-red-600 text-sm mt-1" id="error_urgency_level"></div>
            </div>

            <!-- Decision Criteria -->
            <div class="md:col-span-2 xl:col-span-1">
              <label class="block text-sm font-semibold text-gray-700 mb-2">
                What criteria are most important to you when choosing a
                solution?
              </label>
              <textarea name="decision_criteria"
                class="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent resize-none"
                rows="3" placeholder="List your key decision criteria..."><%= formData.decision_criteria %></textarea>
            </div>

            <!-- Evaluation Process -->
            <div class="md:col-span-2 xl:col-span-3">
              <label class="block text-sm font-semibold text-gray-700 mb-2">
                What does your evaluation process look like?
              </label>
              <textarea name="evaluation_process"
                class="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent resize-none"
                rows="3" placeholder="Describe your evaluation process..."><%= formData.evaluation_process %></textarea>
            </div>
          </div>
        </div>

        <!-- Decision Making & Budget Section -->
        <div class="border-b border-gray-200 pb-8">
          <h2 class="text-xl md:text-2xl font-bold text-gray-800 mb-6">
            Decision Making & Budget
          </h2>

          <div class="grid grid-cols-1 md:grid-cols-2 xl:grid-cols-3 gap-6">
            <!-- Decision Makers -->
            <div class="md:col-span-2 xl:col-span-3">
              <label class="block text-sm font-semibold text-gray-700 mb-2">
                Who else is involved in the decision-making process?
              </label>
              <textarea name="decision_makers"
                class="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent resize-none"
                rows="3"
                placeholder="List key stakeholders and decision makers..."><%= formData.decision_makers %></textarea>
            </div>

            <!-- Leadership Alignment -->
            <div>
              <label class="block text-sm font-semibold text-gray-700 mb-2">
                Is the leadership and finance team aligned and ready to move
                forward on this initiative?
              </label>
              <div class="flex space-x-4 mt-2">
                <label class="flex items-center">
                  <input type="radio" name="leadership_aligned" value="Yes" class="text-blue-600 focus:ring-blue-500"
                    <%=formData.leadership_aligned==="Yes" ? "checked" : "" %> />
                  <span class="ml-2 text-sm">Yes</span>
                </label>
                <label class="flex items-center">
                  <input type="radio" name="leadership_aligned" value="No" class="text-blue-600 focus:ring-blue-500"
                    <%=formData.leadership_aligned==="No" ? "checked" : "" %> />
                  <span class="ml-2 text-sm">No</span>
                </label>
              </div>
            </div>
            <!-- Budget Approval -->
            <div>
              <label class="block text-sm font-semibold text-gray-700 mb-2">
                Is the budget for this initiative already approved?
              </label>
              <input type="text" name="budget_approved"
                class="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"
                placeholder="Yes/No/Partially - provide details" value="<%= formData.budget_approved %>" />
            </div>

            <!-- RFP Status -->
            <div>
              <label class="block text-sm font-semibold text-gray-700 mb-2">
                Is there an RFQ / RFP?
              </label>
              <select name="rfp_status"
                class="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent">
                <option value="">Select status</option>
                <option value="Formal RFP" <%=formData.rfp_status==="Formal RFP" ? "selected" : "" %> >Formal RFP
                </option>
                <option value="Generic Questionnaire" <%=formData.rfp_status==="Generic Questionnaire" ? "selected" : ""
                  %> >
                  Generic Questionnaire
                </option>
                <option value="None" <%=formData.rfp_status==="None" ? "selected" : "" %> >None</option>
              </select>
            </div>
          </div>
        </div>
        <div x-data="{ isEcommerce: '<%= formData.is_ecommerce || '' %>' }">
          <div class="mb-8">
            <label class="block text-sm font-semibold text-gray-700 mb-2">
              Is your business ecommerce-specific?
              <span class="text-red-500">*</span>
            </label>
            <div class="flex space-x-6">
              <label class="flex items-center">
                <input type="radio" name="is_ecommerce" value="Yes" x-model="isEcommerce"
                  class="text-blue-600 focus:ring-blue-500" <%=formData.is_ecommerce==='Yes' ? "checked" : "" %> />
                <span class="ml-2 text-sm">Yes</span>
              </label>
              <label class="flex items-center">
                <input type="radio" name="is_ecommerce" value="No" x-model="isEcommerce"
                  class="text-blue-600 focus:ring-blue-500" <%=formData.is_ecommerce==='No' ? "checked" : "" %> />
                <span class="ml-2 text-sm">No</span>
              </label>
            </div>
            <div class="text-red-600 text-sm mt-1" id="error_is_ecommerce"></div>
          </div>

          <!-- Ecommerce Specific Section -->
          <div x-show="isEcommerce === 'Yes'" x-transition>
            <div class="pb-8">
              <h2 class="text-xl md:text-2xl font-bold text-gray-800 mb-6">
                Ecommerce Specific
              </h2>

              <div class="grid grid-cols-1 md:grid-cols-2 xl:grid-cols-3 gap-6">
                <!-- Current Platform -->
                <div>
                  <label class="block text-sm font-semibold text-gray-700 mb-2">
                    Current eCommerce Platform
                    <span class="text-red-500">*</span>
                  </label>
                  <select name="current_platform"
                    class="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent">
                    <option value="">Select platform</option>
                    <option value="Adobe (Magento) Commerce Cloud (M2)"
                      <%=formData.current_platform==="Adobe (Magento) Commerce Cloud (M2)" ? "selected" : "" %> >Adobe
                      (Magento) Commerce Cloud (M2)</option>
                    <option value="Adobe (Magento) OpenSource (M2)"
                      <%=formData.current_platform==="Adobe (Magento) OpenSource (M2)" ? "selected" : "" %> >Adobe
                      (Magento) OpenSource (M2)</option>
                    <option value="BigCommerce" <%=formData.current_platform==="BigCommerce" ? "selected" : "" %>
                      >BigCommerce</option>
                    <option value="Magento Community (M1)" <%=formData.current_platform==="Magento Community (M1)"
                      ? "selected" : "" %> >Magento Community (M1)</option>
                    <option value="Magento Enterprise (M1)" <%=formData.current_platform==="Magento Enterprise (M1)"
                      ? "selected" : "" %> >Magento Enterprise (M1)</option>
                    <option value="Pinnacle Cart" <%=formData.current_platform==="Pinnacle Cart" ? "selected" : "" %>
                      >Pinnacle Cart</option>
                    <option value="Shopify" <%=formData.current_platform==="Shopify" ? "selected" : "" %> >Shopify
                    </option>
                    <option value="SquareSpace" <%=formData.current_platform==="SquareSpace" ? "selected" : "" %>
                      >SquareSpace</option>
                    <option value="Unilog" <%=formData.current_platform==="Unilog" ? "selected" : "" %> >Unilog</option>
                    <option value="Volusion" <%=formData.current_platform==="Volusion" ? "selected" : "" %> >Volusion
                    </option>
                    <option value="WooCommerce" <%=formData.current_platform==="WooCommerce" ? "selected" : "" %>
                      >WooCommerce</option>
                    <option value="Other" <%=formData.current_platform==="Other" ? "selected" : "" %> >Other</option>
                  </select>
                  <div class="text-red-600 text-sm mt-1" id="error_current_platform"></div>
                </div>
                <!-- Considering Platforms -->
                <div>
                  <label class="block text-sm font-semibold text-gray-700 mb-2">
                    eCommerce Platform(s) Considering
                    <span class="text-red-500">*</span>
                  </label>
                  <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-2">
                    <label class="flex items-center space-x-2">
                      <input type="checkbox" name="considering_platforms[]" value="Adobe OpenSource"
                        class="rounded text-blue-600 focus:ring-blue-500" <%=formData.considering_platforms &&
                        formData.considering_platforms.includes("Adobe OpenSource") ? "checked" : "" %> />
                      <span class="text-sm">Adobe OpenSource</span>
                    </label>
                    <label class="flex items-center space-x-2">
                      <input type="checkbox" name="considering_platforms[]" value="Adobe Commerce"
                        class="rounded text-blue-600 focus:ring-blue-500" <%=formData.considering_platforms &&
                        formData.considering_platforms.includes("Adobe Commerce") ? "checked" : "" %> />
                      <span class="text-sm">Adobe Commerce</span>
                    </label>
                    <label class="flex items-center space-x-2">
                      <input type="checkbox" name="considering_platforms[]" value="BigCommerce"
                        class="rounded text-blue-600 focus:ring-blue-500" <%=formData.considering_platforms &&
                        formData.considering_platforms.includes("BigCommerce") ? "checked" : "" %> />
                      <span class="text-sm">BigCommerce</span>
                    </label>
                    <label class="flex items-center space-x-2">
                      <input type="checkbox" name="considering_platforms[]" value="Shopify"
                        class="rounded text-blue-600 focus:ring-blue-500" <%=formData.considering_platforms &&
                        formData.considering_platforms.includes("Shopify") ? "checked" : "" %> />
                      <span class="text-sm">Shopify</span>
                    </label>
                    <label class="flex items-center space-x-2">
                      <input type="checkbox" name="considering_platforms[]" value="WooCommerce"
                        class="rounded text-blue-600 focus:ring-blue-500" <%=formData.considering_platforms &&
                        formData.considering_platforms.includes("WooCommerce") ? "checked" : "" %> />
                      <span class="text-sm">WooCommerce</span>
                    </label>
                    <label class="flex items-center space-x-2">
                      <input type="checkbox" name="considering_platforms[]" value="Other"
                        class="rounded text-blue-600 focus:ring-blue-500" <%=formData.considering_platforms &&
                        formData.considering_platforms.includes("Other") ? "checked" : "" %> />
                      <span class="text-sm">Other</span>
                    </label>
                    <label class="flex items-center space-x-2">
                      <input type="checkbox" name="considering_platforms[]" value="Undecided"
                        class="rounded text-blue-600 focus:ring-blue-500" <%=formData.considering_platforms &&
                        formData.considering_platforms.includes("Undecided") ? "checked" : "" %> />
                      <span class="text-sm">Undecided</span>
                    </label>
                  </div>
                  <div class="text-red-600 text-sm mt-1" id="error_considering_platforms"></div>
                </div>

                <!-- Business Type -->
                <div>
                  <label class="block text-sm font-semibold text-gray-700 mb-2">
                    Business Type <span class="text-red-500">*</span>
                  </label>
                  <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-2">
                    <label class="flex items-center space-x-2">
                      <input type="checkbox" name="business_type[]" value="B2B"
                        class="rounded text-blue-600 focus:ring-blue-500" <%=formData.business_type &&
                        formData.business_type.includes("B2B") ? "checked" : "" %> />
                      <span class="text-sm">B2B</span>
                    </label>
                    <label class="flex items-center space-x-2">
                      <input type="checkbox" name="business_type[]" value="B2C"
                        class="rounded text-blue-600 focus:ring-blue-500" <%=formData.business_type &&
                        formData.business_type.includes("B2C") ? "checked" : "" %> />
                      <span class="text-sm">B2C</span>
                    </label>
                    <label class="flex items-center space-x-2">
                      <input type="checkbox" name="business_type[]" value="Other"
                        class="rounded text-blue-600 focus:ring-blue-500" <%=formData.business_type &&
                        formData.business_type.includes("Other") ? "checked" : "" %> />
                      <span class="text-sm">Other</span>
                    </label>
                  </div>
                  <div class="text-red-600 text-sm mt-1" id="error_business_type"></div>
                </div>

                <!-- Annual Revenue -->
                <div>
                  <label class="block text-sm font-semibold text-gray-700 mb-2">
                    Annual Online Revenue <span class="text-red-500">*</span>
                  </label>
                  <select name="annual_revenue"
                    class="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent">
                    <option value="">Select range</option>
                    <option value="< 1M" <%=formData.annual_revenue==="< 1M" ? "selected" : "" %> >
                      < $1M</option>
                    <option value="1M - 5M" <%=formData.annual_revenue==="1M - 5M" ? "selected" : "" %> >$1M - $5M
                    </option>
                    <option value="5M - 10M" <%=formData.annual_revenue==="5M - 10M" ? "selected" : "" %> >$5M - $10M
                    </option>
                    <option value="10M - 50M" <%=formData.annual_revenue==="10M - 50M" ? "selected" : "" %> >$10M - $50M
                    </option>
                    <option value="50M - 100M" <%=formData.annual_revenue==="50M - 100M" ? "selected" : "" %> >$50M -
                      $100M</option>
                    <option value="> 100M" <%=formData.annual_revenue==="> 100M" ? "selected" : "" %> >> $100M</option>
                    <option value="Did not Disclose" <%=formData.annual_revenue==="Did not Disclose" ? "selected" : ""
                      %> >Did not Disclose</option>
                  </select>
                  <div class="text-red-600 text-sm mt-1" id="error_annual_revenue"></div>
                </div>

                <!-- Online Revenue Percentage -->
                <div>
                  <label class="block text-sm font-semibold text-gray-700 mb-2">
                    Percentage from Online Sales
                    <span class="text-red-500">*</span>
                  </label>
                  <select name="online_percentage"
                    class="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent">
                    <option value="">Select percentage</option>
                    <option value="0-25%" <%=formData.online_percentage==="0-25%" ? "selected" : "" %> >0-25%</option>
                    <option value="25-50%" <%=formData.online_percentage==="25-50%" ? "selected" : "" %> >25-50%
                    </option>
                    <option value="50-75%" <%=formData.online_percentage==="50-75%" ? "selected" : "" %> >50-75%
                    </option>
                    <option value="75-100%" <%=formData.online_percentage==="75-100%" ? "selected" : "" %> >75-100%
                    </option>
                    <option value="All offline currently" <%=formData.online_percentage==="All offline currently"
                      ? "selected" : "" %> >
                      All offline currently
                    </option>
                    <option value="Did not Disclose">Did not Disclose</option>
                  </select>
                  <div class="text-red-600 text-sm mt-1" id="error_online_percentage"></div>
                </div>

                <!-- KPIs -->
                <div>
                  <label class="block text-sm font-semibold text-gray-700 mb-2">
                    Important KPIs for your eCommerce business
                  </label>
                  <textarea name="important_kpis"
                    class="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent resize-none"
                    rows="3"
                    placeholder="e.g., conversion rate, AOV, cart abandonment..."><%= formData.important_kpis %></textarea>
                </div>

                <!-- Performance Tracking -->
                <div class="md:col-span-2 xl:col-span-3">
                  <label class="block text-sm font-semibold text-gray-700 mb-2">
                    How are you currently tracking performance across your
                    sales funnel?
                  </label>
                  <textarea name="performance_tracking"
                    class="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent resize-none"
                    rows="3"
                    placeholder="Describe your current tracking methods..."><%= formData.performance_tracking %></textarea>
                </div>

                <!-- Metric Improvement -->
                <div class="md:col-span-2 xl:col-span-3">
                  <label class="block text-sm font-semibold text-gray-700 mb-2">
                    If we could help you increase a metric, what would that
                    be, and what would it mean for your business?
                  </label>
                  <textarea name="metric_improvement"
                    class="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent resize-none"
                    rows="3"
                    placeholder="Which metric and business impact..."><%= formData.metric_improvement %></textarea>
                </div>

                <!-- Top 3 Requirements -->
                <div class="md:col-span-2 xl:col-span-3">
                  <label class="block text-sm font-semibold text-gray-700 mb-2">
                    What are the top 3 things you're looking for from your
                    eCommerce platform/tool?
                  </label>
                  <textarea name="top_requirements"
                    class="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent resize-none"
                    rows="3" placeholder="List your top 3 requirements..."><%= formData.top_requirements %></textarea>
                </div>

                <!-- Tech Stack -->
                <div class="md:col-span-2 xl:col-span-3">
                  <label class="block text-sm font-semibold text-gray-700 mb-2">
                    Current Tech Stack & Integration Requirements
                  </label>
                  <textarea name="tech_stack"
                    class="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent resize-none"
                    rows="3"
                    placeholder="List your current tools and essential integrations..."><%= formData.tech_stack %></textarea>
                </div>

                <!-- Vendor Comparison -->
                <div class="md:col-span-2 xl:col-span-3">
                  <label class="block text-sm font-semibold text-gray-700 mb-2">
                    How are you comparing different vendors or solutions?
                  </label>
                  <textarea name="vendor_comparison"
                    class="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent resize-none"
                    rows="3"
                    placeholder="Describe your comparison process..."><%= formData.vendor_comparison %></textarea>
                </div>

                <!-- Ideal Solution -->
                <div class="md:col-span-2 xl:col-span-3">
                  <label class="block text-sm font-semibold text-gray-700 mb-2">
                    What would your ideal solution look like?
                  </label>
                  <textarea name="ideal_solution"
                    class="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent resize-none"
                    rows="3" placeholder="Describe your ideal solution..."><%= formData.ideal_solution %></textarea>
                </div>

                <!-- Decision Process -->
                <div class="md:col-span-2 xl:col-span-3">
                  <label class="block text-sm font-semibold text-gray-700 mb-2">
                    What does your decision-making process look like from
                    evaluation to purchase?
                  </label>
                  <textarea name="decision_process"
                    class="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent resize-none"
                    rows="3" placeholder="Describe your decision process..."><%= formData.decision_process %></textarea>
                </div>

                <!-- Evaluation Team -->
                <div class="md:col-span-2 xl:col-span-3">
                  <label class="block text-sm font-semibold text-gray-700 mb-2">
                    Who else is involved in the evaluation process?
                  </label>
                  <textarea name="evaluation_team"
                    class="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent resize-none"
                    rows="3" placeholder="List evaluation team members..."><%= formData.evaluation_team %></textarea>
                </div>

                <!-- Decision Timeline -->
                <div>
                  <label class="block text-sm font-semibold text-gray-700 mb-2">
                    When are you hoping to make a final decision?
                  </label>
                  <textarea name="decision_timeline"
                    class="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent resize-none"
                    rows="3" placeholder="Target decision date..."><%= formData.decision_timeline %></textarea>
                </div>

                <!-- Current Setup Challenge -->
                <div class="md:col-span-2 xl:col-span-2">
                  <label class="block text-sm font-semibold text-gray-700 mb-2">
                    What's the biggest challenge you're facing with your
                    current eCommerce setup?
                  </label>
                  <textarea name="current_setup_challenge"
                    class="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent resize-none"
                    rows="3"
                    placeholder="Describe your main challenge..."><%= formData.current_setup_challenge %></textarea>
                </div>

                <!-- Checkout Bottlenecks -->
                <div class="md:col-span-2 xl:col-span-3">
                  <label class="block text-sm font-semibold text-gray-700 mb-2">
                    Are there any bottlenecks in your customer journey or
                    checkout process?
                  </label>
                  <textarea name="checkout_bottlenecks"
                    class="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent resize-none"
                    rows="3" placeholder="Describe any bottlenecks..."><%= formData.checkout_bottlenecks %></textarea>
                </div>
                <div class="md:col-span-2 xl:col-span-3">
                  <label class="block text-sm font-semibold text-gray-700 mb-2">
                    What happens if you don’t solve this problem in the next
                    3–6 months?
                  </label>
                  <textarea name="consequence_unsolved"
                    class="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent resize-none"
                    rows="3"
                    placeholder="Describe the impact if not solved..."><%= formData.consequence_unsolved %></textarea>
                </div>

                <!-- Who on your team would benefit most from this solution? -->
                <div class="md:col-span-2 xl:col-span-3">
                  <label class="block text-sm font-semibold text-gray-700 mb-2">
                    Who on your team would benefit most from this solution?
                  </label>
                  <textarea name="team_benefit"
                    class="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent resize-none"
                    rows="3" placeholder="List team members or roles..."><%= formData.team_benefit %></textarea>
                </div>

                <!-- Is there a department that would be particularly excited about improving their area with this project? -->
                <div class="md:col-span-2 xl:col-span-3">
                  <label class="block text-sm font-semibold text-gray-700 mb-2">
                    Is there a department that would be particularly excited
                    about improving their area with this project?
                  </label>
                  <textarea name="excited_department"
                    class="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent resize-none"
                    rows="3" placeholder="Which department and why?"><%= formData.excited_department %></textarea>
                </div>
              </div>
            </div>
          </div>

          <div>
            <div class="pb-8">
              <h2 class="text-xl md:text-2xl font-bold text-gray-800 mb-6">
                More Information
              </h2>
              <div class="grid grid-cols-1 md:grid-cols-2 xl:grid-cols-3 gap-6">
                <div>
                  <label class="block text-sm font-semibold text-gray-700 mb-2">
                    Presales Person
                  </label>
                  <select name="presales"
                    class="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent">
                    <option value="">Select Presales</option>
                    <% presalesNames.forEach(function(name) { %>
                      <option value="<%= name %>" <%=formData.presales===name ? "selected" : "" %> ><%= name %>
                      </option>
                      <% }); %>
                  </select>
                </div>
                <div>
                  <label class="block text-sm font-semibold text-gray-700 mb-2">
                    Commerce BDR
                  </label>
                  <select name="commerce_bdr"
                    class="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent">
                    <option value="">Select Commerce BDR</option>
                    <% commerce_bdrNames.forEach(function(name) { %>
                      <option value="<%= name %>" <%=formData.commerce_bdr===name ? "selected" : "" %> ><%= name %>
                      </option>
                      <% }); %>
                  </select>
                </div>
                <div>
                  <label class="block text-sm font-semibold text-gray-700 mb-2">
                    Product Sales
                  </label>
                  <select name="product_sales"
                    class="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent">
                    <option value="">Select Product Sales</option>
                    <% product_salesNames.forEach(function(name) { %>
                      <option value="<%= name %>" <%=formData.product_sales===name ? "selected" : "" %> ><%= name %>
                      </option>
                      <% }); %>
                  </select>
                </div>
                <div>
                  <label class="block text-sm font-semibold text-gray-700 mb-2">
                    Commerce Sales
                  </label>
                  <select name="commerce_sales"
                    class="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent">
                    <option value="">Select Commerce Sales</option>
                    <% commerce_salesNames.forEach(function(name) { %>
                      <option value="<%= name %>" <%=formData.commerce_sales===name ? "selected" : "" %> ><%= name %>
                      </option>
                      <% }); %>
                  </select>
                </div>

                <div>
                  <label class="block text-sm font-semibold text-gray-700 mb-2">
                    Solutioning (SA/Dev/Creatives)
                  </label>
                  <input type="text" name="solutioning___sa_dev_creatives_"
                    class="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"
                    placeholder="Enter name" value="<%= formData.solutioning___sa_dev_creatives_ %>" />
                  <div class="text-red-600 text-sm mt-1" id="error_solutioning___sa_dev_creatives_"></div>
                </div>
              </div>
            </div>
          </div>
        </div>
        <div class="flex justify-end mt-8">
          <button type="submit"
            class="bg-blue-600 hover:bg-blue-700 text-white font-semibold py-3 px-8 rounded-lg shadow transition duration-150">
            Submit
          </button>
        </div>
      </form>
    </main>
  </div>

  <!-- Javascript -->
  <script>
    document
      .getElementById("bdrForm")
      .addEventListener("submit", async function (e) {
        e.preventDefault();
        const form = e.target;
        const submitBtn = form.querySelector('button[type="submit"]');
        const loader = document.getElementById("form-loader");
        submitBtn.disabled = true;
        loader.classList.remove("hidden");
        submitBtn.classList.add("opacity-50", "cursor-not-allowed");

        const formData = new FormData(form);

        // Collect all form values (single and multi)
        const data = {};
        // 1. Single-value fields
        for (const [key, value] of formData.entries()) {
          if (!key.endsWith("[]")) data[key] = value;
        }
        // 2. Multi-value (checkbox) fields
        form.querySelectorAll('input[type="checkbox"]').forEach((cb) => {
          if (cb.name.endsWith("[]")) {
            const key = cb.name.slice(0, -2);
            if (!data[key]) data[key] = [];
            if (cb.checked) data[key].push(cb.value);
          }
        });

        // --- VALIDATION SECTION ---
        // Clear all error messages
        form
          .querySelectorAll(".text-red-600")
          .forEach((div) => (div.textContent = ""));

        let hasError = false;
        function showInputError(field, msg) {
          const errDiv = document.getElementById("error_" + field);
          if (errDiv) errDiv.textContent = msg;
          hasError = true;
        }

        // Example required validations
        if (!data.company_background) {
          showInputError(
            "company_background",
            "Please enter your company background."
          );
        }
        if (!data.contact_role) {
          showInputError("contact_role", "Please specify your role.");
        }
        if (!data.hear_about_us) {
          showInputError("hear_about_us", "Tell us how you heard about us.");
        }
        if (!data.interested_in || data.interested_in.length === 0) {
          showInputError("interested_in", "Select at least one interest.");
        }
        if (
          !data.services_interested ||
          data.services_interested.length === 0
        ) {
          showInputError(
            "services_interested",
            "Select at least one service."
          );
        }
        if (!data.implementation_timeline) {
          showInputError(
            "implementation_timeline",
            "Select your timeline for implementation."
          );
        }
        if (!data.urgency_level) {
          showInputError("urgency_level", "Specify the urgency level.");
        }
        if (!data.is_ecommerce) {
          showInputError(
            "is_ecommerce",
            "Please select whether you're an eCommerce business."
          );
        }
        if (data.is_ecommerce === "Yes") {
          if (!data.current_platform) {
            showInputError(
              "current_platform",
              "Specify your current eCommerce platform."
            );
          }
          if (
            !data.considering_platforms ||
            data.considering_platforms.length === 0
          ) {
            showInputError(
              "considering_platforms",
              "Select at least one platform you're considering."
            );
          }
          if (!data.business_type || data.business_type.length === 0) {
            showInputError("business_type", "Select your business type.");
          }
          if (!data.annual_revenue) {
            showInputError(
              "annual_revenue",
              "Provide your annual online revenue."
            );
          }
          if (!data.online_percentage) {
            showInputError(
              "online_percentage",
              "Provide the percentage of online revenue."
            );
          }
        }

        if (hasError) {
          submitBtn.disabled = false;
          loader.classList.add("hidden");
          submitBtn.classList.remove("opacity-50", "cursor-not-allowed");
          Toastify({
            text: "❌ Please fill all required fields.",
            duration: 4000,
            gravity: "top",
            position: "right",
            backgroundColor:
              "linear-gradient(90deg, #ef4444 0%, #f59e42 100%)",
            stopOnFocus: true,
            close: true,
            style: {
              fontSize: "1rem",
              fontWeight: "500",
              borderRadius: "0.5rem",
              boxShadow: "0 4px 24px 0 rgba(239,68,68,0.10)",
              padding: "1.25rem 2rem",
              color: "#fff",
            },
            offset: { x: 20, y: 70 },
            icon: "❌",
          }).showToast();
          return;
        }

        // Prepare data for submission
        const params = new URLSearchParams();
        Object.entries(data).forEach(([key, val]) => {
          if (Array.isArray(val)) {
            val.forEach((v) => params.append(key, v));
          } else if (val != null && val !== "") {
            params.append(key, val);
          }
        });

        try {
          const response = await fetch(form.action, {
            method: "POST",
            headers: { Accept: "application/json" },
            body: params,
          });
          const result = await response.json();
          if (!response.ok && result.errors) {
            submitBtn.disabled = false;
            submitBtn.classList.remove("opacity-50", "cursor-not-allowed");
            // Show Toastify for general error
            Toastify({
              text: "❌ Please fill all required fields.",
              duration: 4000,
              gravity: "top",
              position: "right",
              backgroundColor:
                "linear-gradient(90deg, #ef4444 0%, #f59e42 100%)",
              stopOnFocus: true,
              close: true,
              style: {
                fontSize: "1rem",
                fontWeight: "500",
                borderRadius: "0.5rem",
                boxShadow: "0 4px 24px 0 rgba(239,68,68,0.10)",
                padding: "1.25rem 2rem",
                color: "#fff",
              },
              offset: { x: 20, y: 70 },
              icon: "❌",
            }).showToast();

            // Show field errors
            Object.entries(result.errors).forEach(([field, msg]) => {
              const errDiv = document.getElementById("error_" + field);
              if (errDiv) errDiv.textContent = msg;
            });
            return;
          }

          Toastify({
            text: `✅ ${result.message || "Form submitted!"}`,
            duration: 5000,
            gravity: "top",
            position: "right",
            backgroundColor:
              "linear-gradient(90deg, #2563eb 0%, #22d3ee 100%)",
            stopOnFocus: true,
            close: true,
            style: {
              fontSize: "1rem",
              fontWeight: "500",
              borderRadius: "0.5rem",
              boxShadow: "0 4px 24px 0 rgba(34,197,94,0.10)",
              padding: "1.25rem 2rem",
              color: "#fff",
            },
            offset: { x: 20, y: 70 },
            icon: "✅",
          }).showToast();
          // form.reset();
        } catch (err) {
          Toastify({
            text: "❌ Submission failed. Please try again.",
            duration: 5000,
            gravity: "top",
            position: "right",
            backgroundColor:
              "linear-gradient(90deg, #ef4444 0%, #f59e42 100%)",
            stopOnFocus: true,
            close: true,
            style: {
              fontSize: "1rem",
              fontWeight: "500",
              borderRadius: "0.5rem",
              boxShadow: "0 4px 24px 0 rgba(239,68,68,0.10)",
              padding: "1.25rem 2rem",
              color: "#fff",
            },
            offset: { x: 20, y: 70 },
            icon: "❌",
          }).showToast();
        } finally {
          submitBtn.disabled = false;
          submitBtn.classList.remove("opacity-50", "cursor-not-allowed");
          loader.classList.add("hidden");
        }
      });
  </script>
</body>

</html>